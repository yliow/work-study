\section{Pumping Lemma for CFL}

There's corresponding Pumping Lemma for CFL:

\begin{lem}
If $L$ is a CFL over $\Sigma$, then there is some $n$ such that for
all $z \in L$, if $|z|\geq n$, then there are $u,v,w,x,y,z \in
\Sigma*$ such that
\begin{tightlist}
 \item $z = uvwxy$
 \item $|vwx| \leq n$
 \item $|vx| \geq 1$
 \item for all $i \geq 0$, $uv^iwx^iy \in L$.
\end{tightlist}
\end{lem}

Just like the Pumping Lemma for regular languages, we usually use
the contrapositive of the above statement to prove that a language
is not a CFL:

\begin{lem}
Let $L$ is be a language over $\Sigma^*$. If for all $n \geq 0$,
there is some $z \in L$ such that $|z| \geq n$ and if for any
$u,v,w,x,y \in \Sigma^*$ such that
\begin{tightlist}
 \item $z = uvwxy$
 \item $|vwx| \leq n$
 \item $|vx| \geq 1$
 \item there is some $i_0$ such that $uv^{i_0} w x^{i_0} y \notin
 L$,
then $L$ is not a CFL.
\end{tightlist}
\end{lem}



\newpage
\begin{eg}
Let $L = \{a^mb^mc^m \,|\, m \geq 0\}$. Prove that $L$ is not a CFL
using the Pumping Lemma for CFL.
\end{eg}

\textbf{Solution.} Let $n \geq 0$. Choose $z = a^nb^nc^n$. Note that $z
\in L$ and $|z| \geq n$. Now suppose $z = uvwxy$ where
\begin{tightlist}
\item $|vwx|\leq n$
\item $|vx| \geq 1$
\end{tightlist}

Note that since $|vwx| \leq n$ and that $vwx$ is a substring of
$a^nb^nc^n$, we note that $vwx$ cannot contain more than two symbols
in $\Sigma$. That means that when we remove $v$ and $x$ from $vwx$
we remove at most two types of symbols. Similar, when we consider
$uv^0wx^0y$, i.e., the string with $uvwxy$ with $v$ and $w$ removed,
$uv^0wx^0y$ must have at most two types of characters removed. Note
also that since $|vx| \geq 1$, at least one character is indeed
removed from $uvwxy$ in order to obtain $uv^0wx^0y$. This means that
$uv^0wx^0y$ cannot be of the form $a^i b^i c^i$ for some $i$. Hence
$uv^0wx^0y \notin L$.

Therefore by the Pumping Lemma for CFL, $L$ is not a CFL. 
\qed

Here's a ... DANGEROUS BEND WARNING! ...
Note that the part being pumped is {\it not} a prefix;
compare this with the Pumping Lemma for regular languages.
Therefore for applications of Pumping Lemma for CFL, the section to be pumped
$vwx$ can be anywhere in $z$.
In the above example we chose $z = a^n b^n c^n$.
And the strategy was to look at all the possible $vwx$:
\begin{verbatim}
      n terms       n terms       n terms
    <--------->   <--------->   <--------->
z = a.........a | b.........b | c.........c

     <------->
           <------->
                   <------->
                          <------->
                                 <------->
\end{verbatim}

As you can see we have to consider cases where $vwx$ is not a prefix.
And of course we choose our $z$ so as to control possibilities of $vwx$, i.e.
so that it can be made up of at most two type of characters.




\newpage
\begin{ex}
Prove that $L = \{ a^m b^m a^m b^m \st m \geq 0 \}$ is not a CFL.
\end{ex}



\newpage
\begin{ex}
Prove that $L = \{ a^m b^n a^m b^n \st m, n \geq 0 \}$ is not a CFL.
\end{ex}

\newpage
\begin{ex}
Prove that $L = \{ a^k b^{2k} a^k b^{2k} \mid k \geq 0 \}$ is not a CFL.
\end{ex}

\newpage
\begin{ex}
Is $L = \{ a b^{k} a^k b^{k} \mid k \geq 0 \}$ a CFL.
\end{ex}


\newpage
\begin{ex}
Let $L = \{ a b a^2 b a^3 b \cdots a^n b \mid n \geq 1 \}$.
Is $L$ regular? Context free? Neither?
\end{ex}


\newpage
\begin{ex}
Is $L = \{ a^{n^2} \mid n \geq 1 \}$.
context free?
\end{ex}

\newpage
\begin{ex}
Is $L = \{ a^p \mid p \text { prime}\}$
context free?
\qed
\end{ex}




\newpage
Just like in the case of using the pumping lemma for regular languages, 
sometimes the language is \lq\lq messy'' and you want to tidy it up.
Recall that if $L_1$ is a CFL and $L_2$ is regular,
then $L_1 \cap L_2$ is a also a CFL.
So the following example is not too surprising ...



\begin{eg}
Let $L = \{w \st w \text{ has equal number of $a$'s, $b$'s, and $c$'s} \}$.
Prove that $L$ is not a CFL.
\end{eg}

\textbf{Solution.}
Assume on the contrary that $L$ is a CFL.
Note that $L(a^*b^*c^*)$ is regular.
Then $L \cap L(a^*b^*c^*)$ is also CFL.
Now note that
\[
L \cap L(a^*b^*c^*) 
= \{a^m b^m c^m \st m \geq 0 \}
\]
We have already show that $\{a^m b^m c^m \st m \geq 0 \}$
is not a CFL.
Hence $L$ is not a CFL.
\qed

\newpage
\begin{ex}
Is $\{ww \st w \in \{a, b\}^* \}$ a CFL?
\end{ex}




\newpage
You've seen this before ...

\begin{ex}
Is $\{a^{n^2} \st n \geq 0 \}$ a CFL?
\end{ex}

You want to look at the notes for regular languages for showing
that this language is not regular.
Analyze the above example very carefully and think about
languages like $\{a^{f(n)} \st n \geq 0 \}$ where $f(n)$ is some
basic function such as $f(n) = n^2$.
How does regularity and context freeness compare for such languages?


\newpage
\begin{proof}
OK. Enough of using PL for CFL. It's time to prove it!

First of all, let's assume $L$ is generated by a grammar $G$ in
Chomsky Normal Form. Recall that this means that all productions are
either $A \rightarrow BC$ or $A \rightarrow a$ where $A,B,C$ are
variables and $a$ is a terminal.

How can we prove the theorem? Why is there two parts that can be
pumped up? (The PL for regular languages have only one).

Suppose we start deriving a string from in $L$ using $G$. The fact
that you can pump the string $uv^iwx^iy$ means that there are
infinitely many strings in $L$. If you recall the proof of the PL
for regular languages, you have the same idea and the idea was that
you can a loop in the directed graph of transitions so that by going
around the circle, you can pump up the string. What about the case
of our CFL $L$? Look at the following:
\[
 S \istar \alpha_1 A \beta_1 \istar \alpha_2 A \beta_2 \istar uvwxy
\]
Suppose $A \istar vAx|w$. Let's redo the above:
\[
 S \istar \alpha_1 A \beta_1 \istar \alpha_1 (vAx) \beta_1
\]
AHA! Now of course we can just derive $w$ from $A$ at this point.
But $\ldots$, we can instead do this:
\[
 S \istar \alpha_1 A \beta_1 \istar \alpha_1 v A x\beta_1 \istar
 \alpha_1 vvA xx \beta_1
\]
AHA! We pumped up! Of course from the previous derivation, we could
have pumped down instead:
\[
 S \istar \alpha_1 A \beta_1 \istar \alpha_1 w \beta_1
\]
All we need to say now is that $\alpha_1 \istar x$, $\beta_1 \istar
y$. Everything is done $\ldots$ except that we still need to prove
that there is a production of the form $A \istar uAx$.

Now look at a derivation $S \istar x$. Supposing that $G$ is
already in Chomsky Normal Form, then variable is replaced by two
(or by a terminal. That means that if the are $n$ steps in the
derivation, then there are at most $2^n$ leaves (which in this
case would be terminals). Now look at $S \istar \alpha_1 A \beta_1
\istar \alpha_2 A \beta_2 \istar z$, specifically look at the
derivation tree. 
There is a path from $S$ to the first $A$ and
then to the second $A$. 
This is a path of variables. 
Now why is it that there is a repeat in a variable?
That's because there is a path of length at least $k + 1$ and $k$ is the
number of variables!
Pigeonhole Principle again!
(Do you see where the $|vwx| \leq n$ and $|vx| \geq 1$ comes from?)
\end{proof}
