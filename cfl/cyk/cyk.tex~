\section{Cocke--Younger--Kasami Algorithm}

This is an algorithm that determine if a string is generated by a CFG and if 
it does, it gives a derivation, i.e., it is a string parsing algorithm.
The time complexity if $O(n^3)$ where $n$ is the length of the string.
(There are faster algorithms. 
For instance there is one with time complexity $O(n^{2.8})$.)
The algorithm uses a very important technique in the design of algorithms
-- dynamic programming technique -- to build up a solution by combining
subroutines (see CISS358.)

Of course you can parse string $w$ without CYK:
If $w$ is $\ep$, just check if $S$ is a nullable symbol.
If not, then you just check every possible sequence of $|w|$ productions.
Is this a good algorithm?
(Note sarcasm ...)

The main idea of CYK is very simple.
First we assume the grammar $G$ is in Chomsky Normal Form.
Now suppose our string is $w$ of length $n$.
Let $w_{i,j}$ denote the substring of $w$ starting at position $i$ with 
length $j$.
The first position is $1$ and the last position is $n$.
The string $w$ is just
\[
w = w_{1,1} w_{2,1} w_{3,1} w_{4,1} \cdots w_{n,1}
\]

\begin{eg} 
Let $w = baabaa$. Then $w_{2,3} = aab$.
\end{eg}

First of all we can always determine if each $w_{i,1}$ can \textred{be}
derived:
$A$ derives $w_{i,1}$ if and only if $A \rightarrow w_{i,1}$ is a production
(don't forget that we're assuming the grammar is in Chomsky Normal Form).

What about the general case?
How do you generate $w_{i,j}$?
This is a string starting at position $i$ and of length $j$.
What happens when you cut up the string?
Suppose you break it up \textred{into} two strings $w_{i,j} = xy$.
Well, $x$ starts at the same position right?
So it must be of the form
\[
x = w_{i,k}
\]
Since $x$ is a substring of $w_{i,j}$, it's length must be at most $j$.
Therefore $k \leq j$.
But let's assume that we really did cut up the string so that $y$ is not the 
empty string.
So $k < j$.
OK.
So we have $w_{i,j} = w_{i,k} y$ where $k < j$.
Now what about $y$?
$y$ starts at position $i + k$ right?
And what is the length of $y$?
It's $|w| - |x|$ which is $j - k$.
Therefore $w_{i,j}$ is the concatenation of $w_{i,k}$ and $w_{i+k, j-k}$
where $k < j$ (i.e., $k = 1, 2, \ldots, j - 1$):
\[
w_{i,j} = w_{i,k} w_{i+k, j-k}, \hskip 1cm (k = 1, 2, \ldots, j - 2)
\]
So what we'll do i\textred{s}
to find a variable, say $X$, deriving $w_{i,k}$ and 
another, say $Y$, deriving $w_{i+k, j-k}$ for all the given $k$'s.
That means that $XY$ derives $w_{i,y}$.
If the grammar is in Chomsky Normal Form, we will then look at the 
production rules to find a rule of the form $Z \rightarrow XY$.
If this is found, then $Z$ must derive $XY$ which derives $w_{i,j}$.
That's the main idea.
Instead of giving you the algorithm, let's go through an example first.

\begin{eg}
Consider the grammar:
\begin{align*}
S &\rightarrow AB \st AC \\
A &\rightarrow BC \st a \\
B &\rightarrow CB \st b \\
C &\rightarrow AA \st b
\end{align*}
Note that this is already in Chomsky Normal Form.
Is $baaab$ generated by the grammar?
\end{eg}

\textbf{Solution.}
For this example $w = baaab$.
We will systematically tabular the variables deriving $w_{i,j}$.
The variables deriving $w_{i,j}$ will be placed at row $j$ and column $i$:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$ & $a$ & $a$ & $a$ & $a$ & $b$ \\
  & 1 & 2 & 3 & 4 & 5 & 6 \\ \hline \hline
1 &   &   &   &   &   & \\ \hline
2 &   &   &   &   &   & \\ \hline
3 &   &   &   &   &   & \\ \hline
4 &   &   &   &   &   & \\ \hline
5 &   &   &   &   &   & \\ \hline
6 &   &   &   &   &   & \\ \hline
\end{tabular}
\end{center}

\underline{First Row}:
We first work out $w_{i,1} = b$:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$ & $a$ & $a$ & $a$ & $a$ & $b$ \\
  & 1 & 2 & 3 & 4 & 5 & 6 \\ \hline \hline
1 & ? &   &   &   &   & \\ \hline
2 &   &   &   &   &   & \\ \hline
3 &   &   &   &   &   & \\ \hline
4 &   &   &   &   &   & \\ \hline
5 &   &   &   &   &   & \\ \hline
6 &   &   &   &   &   & \\ \hline
\end{tabular}
\end{center}
$b$ is derived only by $B \rightarrow b$ and $C \rightarrow b$:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$ \\
  & 1     & 2   & 3   & 4   & 5   & 6   \\ \hline \hline
1 & $B,C$ &     &     &     &     &     \\ \hline
2 &       &     &     &     &     &     \\ \hline
3 &       &     &     &     &     &     \\ \hline
4 &       &     &     &     &     &     \\ \hline
5 &       &     &     &     &     &     \\ \hline
6 &       &     &     &     &     &     \\ \hline
\end{tabular}
\end{center}
$a$ is derived by $A \rightarrow a$. This allows us to complete
the first row:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$ & $A$ & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 &       &     &     &     &     &       \\ \hline
3 &       &     &     &     &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}

In summary, to fill the first row, you need only to look at the
productions of the form $\langle variable \rangle \rightarrow \langle terminal
\rangle$.
(Don't memorize this. You should understand the goal and the math involved.)

\underline{Second Row}:
Now let's look at the $j=2, i=1$, i.e. $w_{1, 2}$:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$ & $A$ & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & ?     &     &     &     &     &       \\ \hline
3 &       &     &     &     &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}
Now
\[
w_{1,2} = w_{1,1} w_{2,1}
\]
(There's only one way to cut up $w_{1,2}$ into two proper substrings.)
But we already know that the variable deriving $w_{1,1}$ is at the $(1,1)$
entry in the table: it's either $B$ or $C$.
We also know that the variable deriving $w_{2,1}$ is at the $(1,2)$ entry;
this is $A$.
Therefore we want to find a variable $V$ such that 
\[
V \rightarrow BA
\]
or
\[
V \rightarrow CA
\]
is a production rule.
(Why do we consider only this scenario? Let's hear it ... 
{\it Chomsky, Chomsky, Chomsky, ...}
$BA$ and $CA$ does not appear on the right-hand side of the productions in 
the grammar.
So there are no such $V$s.
READ THIS PARAGRAPH AGAIN!

The cells we looked at in order to fill the entry at $(2,1)$ are marked
\textbf{[1]}:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & \textbf{[1]:}$B,C$ & \textbf{[1]:}$A$ & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ &     &     &     &     &       \\ \hline
3 &       &     &     &     &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}

Using the same idea, we can fill in the entry at $(2,2)$:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$ & \textbf{[1]:}$A$ & \textbf{[1]:}$A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$    &     &     &     &       \\ \hline
3 &       &     &     &     &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}
Here, $C$ derives $AA$.
The data next to $C$, i.e. $(1,2)$ and $(1,3)$, tells us that $C$
is derived by the variable at cell $(1,2)$ and the variable at cell $(1,3)$.
(Again to help you read computation here, 
the cells we used are marked \textbf{[1]}.)

Here's the table with row 2 completed:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$ & $A$ & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 &       &     &     &     &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}

Again, recall the aim: We're trying to fill the $(j,i)$ 
entry of the table with a variable that can derive $w_{i,j}$.

\underline{Third Row}:
Now we look at $j = 3, i = 1$:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$ & $A$ & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & ?     &     &     &     &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}
We're trying to find a variable $V$ that derives $w_{1,3}$.
Recall from the above that we want to make use of previous results.
The following are the possible ways of breaking up $w_{1,3}$:
\[
w_{1,1}w_{2,2} \hskip 1cm \text{or} \hskip 1cm w_{1,2} w_{3,1}
\]
In other words if $w_{1, 3}$ is $xyz$ then the two ways to break up 
$w_{1,3}$ into two proper substrings are:
\[
x \cdot yz \hskip 1cm \text{or} \hskip 1cm  xy \cdot z
\]

We already know that the variable deriving $w_{1,1}$ is in the
entry at $(1,1)$ of the table: it's $B$ or $C$.
For $w_{2,2}$, just look at the entry at $(2,2)$; $C$ derives 
$w_{2,2}$.
Therefore $BC$ and $CC$ derives $w_{1,1}w_{2,2}$ which is just 
$w_{1, 3}$.
Now we want to find $V$ that derives $BC$ or $CC$ and enter that
into the $(3,1)$ entry of the table.
Checking the grammar, we see that only $A$ can do this.
Therefore we have
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & \textbf{[1]:}$B,C$ & $A$ & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & \textbf{[1]:}$C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ &     &     &     &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}
We're not done yet because $w_{1,3}$ can also be $w_{1,2} w_{3,1}$.
The relevant cells we used are marked \textbf{[2]}:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$ & \textbf{[2]:}$A$ & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & \textbf{[2]:}$\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ &     &     &     &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}

When you check the entry at $(2,1)$, you see that no variable can derive $w_{1,2}$.
Therefore we have nothing else to add to the entry at $(3,1)$.
Altogether we have:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$ & $A$ & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ &     &     &     &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}

Notice that while working on the entry at $(3,1)$, we looked at 
$(1,1),(2,2)$ and also $(2,1),(1,3)$.
Do you notice that there's a pattern in the pairs of cells that
contribute to the two cases in filling the cell at $(3,1)$?
\begin{center}
\begin{tabular}{|l||l|l|l|}
\hline
  & 1          & 2          & 3          \\ \hline \hline
1 & \textbf{[1]:} &            & \textbf{[2]:} \\ \hline
2 & \textbf{[2]:} & \textbf{[1]:} &            \\ \hline
3 & ?          &            &            \\ \hline
\end{tabular}
\end{center}

Now we move on the the entry at $(3,2)$:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$ & $A$ & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & ?   &     &     &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}

This corresponds to $w_{2,3}$ and
\[
w_{2,3} = w_{2,1}w_{3,2} \hskip 1cm \text{or} \hskip 1cm w_{2,2}w_{4,1}
\] 
First for $w_{2,3} = w_{2,1}w_{3,2}$, we want to find a variables that can derive
$AC$; there's only one: $S$.
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$ & \textbf{[1]:}$A$ & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$ & \textbf{[1]:}$C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$   &     &     &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}
For $w_{2,3} = w_{2,2}w_{4,1}$, we want to find variables 
that can derive $CA$: there isn't any.
So there's nothing to add:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$ & $A$ & $A$ & \textbf{[2]:}$A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & \textbf{[2]:}$C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$   &     &     &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}

Notice the patterns of the pairs of cells that contribute to the 
computation at $(3,2)$:
\begin{center}
\begin{tabular}{|l||l|l|l|l|}
\hline
  & 1     & 2   & 3         & 4         \\ \hline \hline
1 & & \textbf{[1]} &           & \textbf{[2]} \\ \hline
2 & & \textbf{[2]} & \textbf{[1]} &           \\ \hline
3 & & ?         &           &           \\ \hline
\end{tabular}
\end{center}

Now following the same method, complete the second row yourself.
[PAUSE]

The table now should look like this:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$ & $A$ & $A$ & \textbf{[2]:}$A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & \textbf{[2]:}$C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$ & $S_{:(1,3),(2,4)}$ & $B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}

\underline{Fourth Row}:
Now we look at the entry for $(4,1)$.
I think you can see the pattern now.
Basically you need to look at the following cases:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & \textbf{[1]:}$B,C$ & $A$ & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & \textbf{[1]:}$S_{:(1,2),(2,3)}$ & $S_{:(1,3),(2,4)}$ & $B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}
(there is no variable deriving $BS$ or $CS$)
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$ & $A$ & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & \textbf{[2]:}$\emptyset$ & $C_{:(1,2),(1,3)}$ & \textbf{[2]:}$C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$ & $S_{:(1,3),(2,4)}$ & $B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 &       &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}
(there cannot be a derivation here since $w_{2,1}$ cannot be derived by a variable)
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$   & $a$ & $a$ & $a$ & $a$ & $b$   \\
  & 1     & 2   & 3   & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$ & $A$ & $A$ & \textbf{[3]:}$A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & \textbf{[3]:}$A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$ & $S_{:(1,3),(2,4)}$ & $B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 & $C_{(3,1),(1,4)}$ &     &     &     &     &       \\ \hline
5 &       &     &     &     &     &       \\ \hline
6 &       &     &     &     &     &       \\ \hline
\end{tabular}
\end{center}
($C$ derives $AA$).

Again note the traversal pattern:
\begin{center}
\begin{tabular}{|l||l|l|l|l|}
\hline
  & 1         & 2         & 3         & 4         \\ \hline \hline
1 & \textbf{[1]} &           &           & \textbf{[3]} \\ \hline
2 & \textbf{[2]} &           & \textbf{[2]} &           \\ \hline
3 & \textbf{[3]} & \textbf{[1]} &           &           \\ \hline
4 & ?         &           &           &           \\ \hline
\end{tabular}
\end{center}

For entry (4,2) you should get:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$         & $a$                & $a$           & $a$ & $a$ & $b$   \\
  & 1           & 2                  & 3             & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$       & \textbf{[1]:}$A$      & $A$ & $A$ & \textbf{[3]:}$A$ & $B,C$ \\ \hline
2 & $\emptyset$ & \textbf{[2]:}$C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & \textbf{[2]:}$C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & \textbf{[3]:}$S_{:(1,2),(2,3)}$ &\textbf{[1]:}$S_{:(1,3),(2,4)}$ & $B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 & $C_{(3,1),(1,4)}$ & $\emptyset$  &               &     &     &       \\ \hline
5 &             &                    &     &     &     &       \\ \hline
6 &             &                    &     &     &     &       \\ \hline
\end{tabular}
\end{center}

For entry (4,3) you should get:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$         & $a$                & $a$           & $a$ & $a$ & $b$   \\
  & 1           & 2                  & 3             & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$       & $A$                & \textbf{[1]:}$A$ & $A$ & $A$ & \textbf{[3]:}$B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$ & \textbf{[2]:}$C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & \textbf{[2]:}$S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$ & \textbf{[3]:}$S_{:(1,3),(2,4)}$ & \textbf{[1]:}$B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 & $C_{(3,1),(1,4)}$ & $\emptyset$  & $S_{:(1,3),(3,4)}$ &     &     &       \\ \hline
5 &             &                    &     &     &     &       \\ \hline
6 &             &                    &     &     &     &       \\ \hline
\end{tabular}
\end{center}

\underline{Fifth Row}:
For entry $(5,1)$ you have the following cases.
First here's the traversal pattern:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$         & $a$                & $a$           & $a$ & $a$ & $b$   \\
  & 1           & 2                  & 3             & 4   & 5   & 6     \\ \hline \hline
1 & \textbf{[1]:}$B,C$       & $A$                & $A$ & $A$ & \textbf{[4]:}$A$ & $B,C$ \\ \hline
2 & \textbf{[2]:}$\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & \textbf{[3]:}$C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & \textbf{[3]:}$A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$ & \textbf{[2]:}$S_{:(1,3),(2,4)}$ & $B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 & \textbf{[4]:}$C_{(3,1),(1,4)}$ & \textbf{[1]:}$\emptyset$  & $S_{:(1,3),(3,4)}$ &     &     &       \\ \hline
5 & ?            &                    &     &     &     &       \\ \hline
6 &             &                    &     &     &     &       \\ \hline
\end{tabular}
\end{center}

Here are the cases:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$         & $a$                & $a$           & $a$ & $a$ & $b$   \\
  & 1           & 2                  & 3             & 4   & 5   & 6     \\ \hline \hline
1 & \textbf{[1]:}$B,C$       & $A$                & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$ & $S_{:(1,3),(2,4)}$ & $B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 & $C_{(3,1),(1,4)}$ & \textbf{[1]:}$\emptyset$  & $S_{:(1,3),(3,4)}$ &     &     &       \\ \hline
5 &             &                    &     &     &     &       \\ \hline
6 &             &                    &     &     &     &       \\ \hline
\end{tabular}
\end{center}
(nothing is added to entry (5,1))

\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$         & $a$                & $a$           & $a$ & $a$ & $b$   \\
  & 1           & 2                  & 3             & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$       & $A$                & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & \textbf{[2]:}$\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$ & \textbf{[2]:}$S_{:(1,3),(2,4)}$ & $B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 & $C_{(3,1),(1,4)}$ & $\emptyset$  & $S_{:(1,3),(3,4)}$ &     &     &       \\ \hline
5 &             &                    &     &     &     &       \\ \hline
6 &             &                    &     &     &     &       \\ \hline
\end{tabular}
\end{center}
(nothing is added to entry (5,1))

\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$         & $a$                & $a$           & $a$ & $a$ & $b$   \\
  & 1           & 2                  & 3             & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$       & $A$                & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & \textbf{[3]:}$C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & \textbf{[3]:}$A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$ & $S_{:(1,3),(2,4)}$ & $B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 & $C_{(3,1),(1,4)}$ & $\emptyset$  & $S_{:(1,3),(3,4)}$ &     &     &       \\ \hline
5 & $S_{(3,1),(2,4)}$ &                    &     &     &     &       \\ \hline
6 &             &                    &     &     &     &       \\ \hline
\end{tabular}
\end{center}
($S$ derives $AC$)

\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$         & $a$                & $a$           & $a$ & $a$ & $b$   \\
  & 1           & 2                  & 3             & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$       & $A$                & $A$ & $A$ & \textbf{[4]:}$A$ & $B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$ & $S_{:(1,3),(2,4)}$ & $B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 & \textbf{[4]:}$C_{(3,1),(1,4)}$ & $\emptyset$  & $S_{:(1,3),(3,4)}$ &     &     &       \\ \hline
5 & $S_{(3,1),(2,4)}$ &                    &     &     &     &       \\ \hline
6 &             &                    &     &     &     &       \\ \hline
\end{tabular}
\end{center}
(no variable derives $CA$)

Altogether we have
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$         & $a$                & $a$           & $a$ & $a$ & $b$   \\
  & 1           & 2                  & 3             & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$       & $A$                & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$ & $S_{:(1,3),(2,4)}$ & $B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 & $C_{(3,1),(1,4)}$ & $\emptyset$  & $S_{:(1,3),(3,4)}$ &     &     &       \\ \hline
5 & $S_{(3,1),(2,4)}$ &                    &     &     &     &       \\ \hline
6 &             &                    &     &     &     &       \\ \hline
\end{tabular}
\end{center}

Using the following traversal pattern, complete (5,2) to get:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$         & $a$                & $a$           & $a$ & $a$ & $b$   \\
  & 1           & 2                  & 3             & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$       & \textbf{[1]:}$A$                & $A$ & $A$ & $A$ & \textbf{[4]:}$B,C$ \\ \hline
2 & $\emptyset$ & \textbf{[2]:}$C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & \textbf{[3]:}$S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & \textbf{[3]:}$S_{:(1,2),(2,3)}$ & $S_{:(1,3),(2,4)}$ & \textbf{[2]:}$B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 & $C_{(3,1),(1,4)}$ & \textbf{[4]:}$\emptyset$  & \textbf{[1]:}$S_{:(1,3),(3,4)}$ &     &     &       \\ \hline
5 & $S_{(3,1),(2,4)}$ & $B_{(2,2),(3,4)}$ &     &     &     &       \\ \hline
6 &             &                    &     &     &     &       \\ \hline
\end{tabular}
\end{center}

\underline{Sixth Row}.
Using the following traversal shown, you should get the following entry for (6,1):
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$         & $a$                & $a$           & $a$ & $a$ & $b$   \\
  & 1           & 2                  & 3             & 4   & 5   & 6     \\ \hline \hline
1 & \textbf{[1]:}$B,C$       & $A$                & $A$ & $A$ & $A$ & \textbf{[5]:}$B,C$ \\ \hline
2 & \textbf{[2]:}$\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & \textbf{[4]:}$S_{:(1,5),(1,6)}$ & \\ \hline
3 & \textbf{[3]:}$A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$ & $S_{:(1,3),(2,4)}$ & \textbf{[3]:}$B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 & \textbf{[4]:}$C_{(3,1),(1,4)}$ & $\emptyset$  & \textbf{[2]:}$S_{:(1,3),(3,4)}$ &     &     &       \\ \hline
5 & \textbf{[5]:}$S_{(3,1),(2,4)}$ & \textbf{[1]:}$B_{(2,2),(3,4)}$ &     &     &     &       \\ \hline
6 & $B_{:(1,1),(2,5)}$ &                    &     &     &     &       \\
  & $S_{:(3,1),(3,4)}$ &                    &     &     &     &       \\ \hline
\end{tabular}
\end{center}
... and we're done!!! Here's the final table:
\begin{center}
\begin{tabular}{|l||l|l|l|l|l|l|}
\hline
  & $b$         & $a$                & $a$           & $a$ & $a$ & $b$   \\
  & 1           & 2                  & 3             & 4   & 5   & 6     \\ \hline \hline
1 & $B,C$       & $A$                & $A$ & $A$ & $A$ & $B,C$ \\ \hline
2 & $\emptyset$ & $C_{:(1,2),(1,3)}$ & $C_{:(1,3),(1,4)}$ & $C_{:(1,4),(1,5)}$ & $S_{:(1,5),(1,6)}$ & \\ \hline
3 & $A_{:(1,1),(2,2)}$ & $S_{:(1,2),(2,3)}$ & $S_{:(1,3),(2,4)}$ & $B_{:(2,4),(1,6)}$ &     &       \\ \hline
4 & $C_{(3,1),(1,4)}$ & $\emptyset$  & $S_{:(1,3),(3,4)}$ &     &     &       \\ \hline
5 & $S_{(3,1),(2,4)}$ & $B_{(2,2),(3,4)}$ &     &     &     &       \\ \hline
6 & $B_{:(1,1),(2,5)}$ &                    &     &     &     &       \\
  & $S_{:(3,1),(3,4)}$ &                    &     &     &     &       \\ \hline
\end{tabular}
\end{center}

So what have we achieved? First of all the entry at $(6,1)$ is $S$.
What does this mean? 
Recall again that this means $S$ can derive $w_{1,6}$, which is the
string we started with, i.e. $baaaab$.
Secondly, you can write down the productions that derive $baaaab$ from $S$.
Can you write them down using the table? [SPOILERS AHEAD ...]

Of course CYK gives you even more.
For instance we also know that $B$ is also in the entry at (6,1).
This means that $B$ can also derive $baaab$.
If you look at the entry at (2,5), you conclude that $B$ can derive $aaab$.
In other words besides addressing the question of whether $baaaab$ can be
generated by the grammar, we have also answered the question for all
substrings of $baaaab$.
Make sure you see this.

OK ... so you know that $S$ can derive $baaaab$ (i.e.
$baaaab \in L(G)$ for the above CFG $G$).
But what is the derivation?
If you've understood the mathematical reasoning so far,
you should have no problems writing down the derivation.
In the following derivation, I also include
the cell location with the variables:
\newcommand\ddd{&\implies}
\begin{align*}
S
\ddd A(3,1) \cdot B(3,4) \\
\ddd B(1,1) \cdot C(2,2) \cdot B(3,4) \hskip 1cm \text{(or $C(1,1)$ instead of $B(1,1)$)} \\
\ddd b \cdot A(1,2) \cdot A(1,3) \cdot B(3,4) \\
\ddd ba \cdot A(1,3) \cdot B(3,4) \\
\ddd baa \cdot B(3,4) \\
\ddd baa \cdot C(2,4) \cdot B(1,6) \\
\ddd baa \cdot A(1,4) \cdot A(1,5) \cdot B(1,6) \\
\ddd baaa \cdot A(1,5) \cdot B(1,6) \\
\ddd baaaa \cdot B(1,6) \\
\ddd baaaab
\end{align*}

\begin{ex}
The above table also tells you that $B$ can also derive $baaaab$.
Write down a dervation of $baaaab$ using variable $B$.
\end{ex}

\begin{ex}
Of course with the above information, you can now
write a simple program to check if a string is generated by a CFG (you
would need the grammar to be in Chomsky Normal Form).
By the way, you can also store the production rule in each cell if you
want your program to list the production rule for each derivation
step. Another thing is that you need to search the list of production 
rules to fill up the table.
You want to think about how you want to represent the list of
production rules.
\end{ex}

\begin{ex}
What if you have a string that's not generated by the grammar?
What do you get when you perform the CYK algorithm on such a string?
\end{ex}

\begin{ex}
Using the above table, are there strings of length 2 in $L(G)$?
What \textred{about} 3? Or 4? Or 5?
Verify by writing down their derivations (if possible).
\end{ex}
